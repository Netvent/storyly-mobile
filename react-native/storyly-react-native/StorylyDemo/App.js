/**
 * Sample React Native App
 *
 * adapted from App.js generated by the following command:
 *
 * react-native init example
 *
 * https://github.com/facebook/react-native
 */

import React, { Component } from 'react';
import { View, Button, Image, Text, PixelRatio } from 'react-native';
import { Storyly } from 'storyly-react-native';

const PIN_ICON = require('./assets/pin_icon.png');


const STORYLY_TOKEN = "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhY2NfaWQiOjc2MCwiYXBwX2lkIjo0MDUsImluc19pZCI6NDA0fQ.1AkqOy_lsiownTBNhVOUKc91uc9fDcAxfQZtpm3nj40"

const convertToNative = (size) => {
    return Platform.OS === 'android' ? PixelRatio.getPixelSizeForLayoutSize(size) : size
}


const CustomPortraitView = ({ storyGroup }) => {
    return (
        <>
            {(storyGroup ? (
                <View style={{ width: 100, height: 178 }}>
                    <Image style={{
                        width: "100%",
                        height: "100%",
                        borderRadius: 8
                    }}
                        source={{ uri: storyGroup.iconUrl }} />
                    <View style={{ width: 100, height: 178, borderRadius: 8, position: 'absolute', backgroundColor: storyGroup.seen ? "#16ad055f" : "#1905ad5f" }}>
                        <View style={{ flexDirection: 'column', width: 90, marginTop: 20, marginLeft: 5, height: "100%", alignItems: 'center', justifyContent: 'flex-start' }}>
                            {storyGroup.pinned ?
                                <Image style={{ width: 20, height: 20, marginTop: 5, marginBottom: 10, borderRadius: 10 }} source={PIN_ICON} /> : <View style={{ width: 20, height: 20, marginTop: 5, marginBottom: 10 }} />}
                            <Text style={{ flexWrap: 'wrap', width: "90%", textAlign: 'center', fontWeight: 'bold', fontSize: 15, color: "white" }}>{storyGroup.title}</Text>
                        </View>
                    </View>
                </View>
            ) : (
                <View style={{ width: "100%", height: "100%", borderRadius: 8 }}></View>
            ))}
        </>
    )
}



export default class App extends Component {
    render() {
        return (
            <View>
                <Storyly
                    style={{ width: '100%', height: 100, marginTop: 50, backgroundColor: "#00ffff" }}
                    storylyId={STORYLY_TOKEN}
                    storyGroupSize="small"
                    storyHeaderShareIcon={"share_icon"}
                    storyHeaderCloseIcon={"close_icon"}
                    storyItemTextTypeface={"Lobster1.4.otf"}
                    storyInteractiveTextTypeface={"Lobster1.4.otf"}
                    onLoad={loadEvent => {
                        console.log(`[Storyly] default - onLoad`);
                    }} />
                <Storyly
                    style={{ width: '100%', height: 120, marginTop: 10, backgroundColor: "#7fff00" }}
                    storylyId={STORYLY_TOKEN}
                    storyGroupSize="large" />
                <Storyly
                    ref={ref => { this.customStoryly = ref }}
                    style={{ width: '100%', height: 170, marginTop: 10, backgroundColor: "#e9967a" }}
                    storylyId={STORYLY_TOKEN}
                    storyGroupSize="custom"
                    storyGroupIconHeight={Platform.OS === 'android' ? PixelRatio.getPixelSizeForLayoutSize(80) : 80}
                    storyGroupIconWidth={Platform.OS === 'android' ? PixelRatio.getPixelSizeForLayoutSize(80) : 80}
                    storyGroupIconCornerRadius={Platform.OS === 'android' ? PixelRatio.getPixelSizeForLayoutSize(20) : 20}
                    storyGroupListHorizontalEdgePadding={Platform.OS === 'android' ? PixelRatio.getPixelSizeForLayoutSize(20) : 20}
                    storyGroupListHorizontalPaddingBetweenItems={Platform.OS === 'android' ? PixelRatio.getPixelSizeForLayoutSize(10) : 10}
                    storyGroupTextTypeface={"Lobster1.4.otf"}
                    storyGroupTextSize={Platform.OS === 'android' ? PixelRatio.getPixelSizeForLayoutSize(20) : 20}
                    storyGroupTextLines={3}
                    storyGroupTextColorSeen={"#00FF00"}
                    storyGroupTextColorNotSeen={"#FF0000"}
                    storyGroupIconBorderColorNotSeen={["#FF0000", "#FF0000"]}
                    storyGroupIconBorderColorSeen={["#FFFFFF", "#FFFFFF"]}
                    storyGroupIconBackgroundColor={"#000000"}
                    storyGroupPinIconColor={"#000000"} />
                <Storyly
                    ref={ref => { this.storyly = ref }}
                    style={{ width: '100%', height: convertToNative(178), marginTop: 10, backgroundColor: "#ff00ff" }}
                    storylyId={STORYLY_TOKEN}
                    storyGroupViewFactory={{
                        width: convertToNative(100),
                        height: convertToNative(178),
                        customView: CustomPortraitView
                    }} />
            </View>
        );
    }
}
